üìå Cheatsheet Wireshark ‚Äì An√°lisis de tr√°fico de Malware
üîπ 1. HTTP / HTTPS (b√°sicos)
http or tls


üëâ Mostrar todo el tr√°fico web (HTTP sin cifrar + HTTPS cifrado).

http.request.method == "GET"


üëâ Localizar todas las peticiones GET (descargas, beaconing).

üîπ 2. Handshakes y conexiones iniciales
tls.handshake.type == 1


üëâ Mostrar todos los Client Hello (inicio de sesi√≥n TLS).

tcp.flags.syn == 1 and tcp.flags.ack == 0


üëâ Mostrar SYN iniciales (intentos de abrir conexiones TCP).

üîπ 3. Filtrar C2 evitando ruido

(ejercicio STRRAT/RedLine)

(http.request or tls.handshake.type eq 1 or (tcp.flags.syn eq 1 and tcp.flags.ack eq 0 and !(ip.dst eq 172.16.1.0/24 or tcp.port eq 443 or tcp.port eq 80))) and !(ssdp)


üëâ Encuentra conexiones sospechosas excluyendo tr√°fico leg√≠timo interno (172.16.1.0/24) y puertos comunes (80/443).

tcp.flags eq 0x0002 and !(tcp.port eq 443) and !(tcp.port eq 80) and !(ip.dst eq 10.7.10.0/24)


üëâ Localiza SYN de C2 evitando tr√°fico web y direcciones internas.

üîπ 4. Identificar Host y Usuario
nbns


üëâ Descubre hostname de la v√≠ctima v√≠a NetBIOS.

kerberos.CNameString


üëâ Descubre nombre de usuario de la v√≠ctima v√≠a Kerberos.

ldap.AttributeDescription == "givenName"


EXTRAS PROTOCOLOS NO CIFRADOS --
Qu√© cubren bien

tcp.stream == N and tcp.len > 0

    Vale para cualquier C2 sobre TCP (HTTP en claro, TCP crudo tipo RedLine/STRRAT, websockets sin TLS, etc.).

    Te muestra solo paquetes con datos (fuera ACKs), as√≠ ves el contenido real (beaconing, √≥rdenes, exfil).

tcp.stream == N and tcp.flags.push == 1

    √ötil cuando el canal es interactivo (comando/respuesta) y el stack usa PSH.

    Te deja ver ‚Äúbloques significativos‚Äù de datos.

tcp.stream == N and tcp contains "tempuri.org" (o la cadena que toque)

    Perfecto para marcadores en claro dentro del stream (namespaces, tokens, rutas, etc.).
