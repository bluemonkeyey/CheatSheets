ğŸ“Œ Cheatsheet Wireshark â€“ AnÃ¡lisis de trÃ¡fico de Malware
ğŸ”¹ 1. HTTP / HTTPS (bÃ¡sicos)
http or tls


ğŸ‘‰ Mostrar todo el trÃ¡fico web (HTTP sin cifrar + HTTPS cifrado).

http.request.method == "GET"


ğŸ‘‰ Localizar todas las peticiones GET (descargas, beaconing).

ğŸ”¹ 2. Handshakes y conexiones iniciales
tls.handshake.type == 1


ğŸ‘‰ Mostrar todos los Client Hello (inicio de sesiÃ³n TLS).

tcp.flags.syn == 1 and tcp.flags.ack == 0


ğŸ‘‰ Mostrar SYN iniciales (intentos de abrir conexiones TCP).

ğŸ”¹ 3. Filtrar C2 evitando ruido

(ejercicio STRRAT/RedLine)

(http.request or tls.handshake.type eq 1 or (tcp.flags.syn eq 1 and tcp.flags.ack eq 0 and !(ip.dst eq 172.16.1.0/24 or tcp.port eq 443 or tcp.port eq 80))) and !(ssdp)


ğŸ‘‰ Encuentra conexiones sospechosas excluyendo trÃ¡fico legÃ­timo interno (172.16.1.0/24) y puertos comunes (80/443).

tcp.flags eq 0x0002 and !(tcp.port eq 443) and !(tcp.port eq 80) and !(ip.dst eq 10.7.10.0/24)


ğŸ‘‰ Localiza SYN de C2 evitando trÃ¡fico web y direcciones internas.

ğŸ”¹ 4. Identificar Host y Usuario
nbns


ğŸ‘‰ Descubre hostname de la vÃ­ctima vÃ­a NetBIOS.

kerberos.CNameString


ğŸ‘‰ Descubre nombre de usuario de la vÃ­ctima vÃ­a Kerberos.

ldap.AttributeDescription == "givenName"
